<div class="containers hall-building">
	<div class="gradient-filter">
		<header class="section one">
			<h1>Hello <%= current_user.first_name %>!</h1>
			<p><%= DateTime.now.strftime("Today is %A, %B %d, %Y") %>.</p>
            <div class="student-overview">
                <div class="overview one">Cooperation: <%= @avg_ratings[:cooperation]%> </div>
                <div class="overview two">Conceptual Contribution: <%= @avg_ratings[:conceptual]%></div>
                <div class="overview three">Practical Contribution: <%= @avg_ratings[:practical]%></div>
                <div class="overview four">Work Ethic: <%= @avg_ratings[:work_ethic]%></div>
            </div>
		</header>

		<section class="section">
			<h2>Upcoming Evaluations</h2>
            <div class="upcoming-evaluations-container">
                <% if @upcoming_evaluations.present? %>
                    <% @upcoming_evaluations.each do |upcoming_evaluation| %>
                        <%= render partial: 'evaluation', locals: {upcoming_evaluation:} %>
                    <% end %>
                <% else %>
                    <h3>--No upcoming evaluations--</h3>
                <% end %>
            </div>
		</section>

        <section class="section"> 
            <h2>Progression Chart</h2>
            <div class="student-chart">
                <% # This will have to be refactored to use @student_evaluations once the 'select a course' page is implemented %>

            <%= line_chart [
                    { name: "Cooperation", data: @student_evaluations_progression.map { |eval| [eval.date_completed, eval.avg_cooperation.to_f] }.to_h },
                    { name: "Conceptual Contribution", data: @student_evaluations_progression.map { |eval| [eval.date_completed, eval.avg_conceptual.to_f] }.to_h },
                    { name: "Practical Contribution", data: @student_evaluations_progression.map { |eval| [eval.date_completed, eval.avg_practical.to_f] }.to_h },
                    { name: "Work Ethic", data: @student_evaluations_progression.map { |eval| [eval.date_completed, eval.avg_work_ethic.to_f] }.to_h }
                ],  
                colors: ["#3bd23b", "#000", "#bd2611", "#0000ff"], 
                min: 0,
                max: 7,
                xtitle: "Time",
                ytitle: "Ratings" 
            %>

            </div>
        </section>
	</div>
</div>

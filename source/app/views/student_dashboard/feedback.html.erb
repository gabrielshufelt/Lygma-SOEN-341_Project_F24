<div class="containers hall-building">
	<div class="gradient-filter">
		<header class="section one">
		<h1>Feedback</h1>
		<h2>Averages</h2>
		<% unless @avg_ratings.empty? %>
			<!-- Student Overview Ratings with colored boxes -->
			<div class="student-overview">
				<div class="overview one">Cooperation: <%= @avg_ratings[:cooperation]%> </div>
				<div class="overview two">Conceptual Contribution: <%= @avg_ratings[:conceptual]%></div>
				<div class="overview three">Practical Contribution: <%= @avg_ratings[:practical]%></div>
				<div class="overview four">Work Ethic: <%= @avg_ratings[:work_ethic]%></div>
			</div>
		<% end %>
		</header>

		<section class="section">
		<h2>Ratings Received</h2>
		<% unless @received_evaluations.empty? %>
			<% @received_evaluations.each do |project_id, project_data| %>
				<%= render 'partials/collapsible_box',
					title: "#{project_data[:project_title]} (Due #{project_data[:due_date]&.strftime('%B %d, %Y') || 'No due date'})",
					collapsed: true,
					content: render('student_dashboard/project_feedback', project_data: project_data)
				%>
			<% end %>
		<% else %>
			<p>No projects with evaluations available yet.</p>
		<% end %>
		</section>

		<section class="section"> 
		<h2>Progression</h2>
		<div class="student-chart">
			<%= line_chart [
				{ name: "Cooperation", data: @progression_data.map { |d| [d[:date_completed], d[:cooperation].to_f] }.to_h },
				{ name: "Conceptual Contribution", data: @progression_data.map { |d| [d[:date_completed], d[:conceptual].to_f] }.to_h },
				{ name: "Practical Contribution", data: @progression_data.map { |d| [d[:date_completed], d[:practical].to_f] }.to_h },
				{ name: "Work Ethic", data: @progression_data.map { |d| [d[:date_completed], d[:work_ethic].to_f] }.to_h }
			],   
			colors: ["#3bd23b", "#000", "#bd2611", "#0000ff"], 
			min: 0,
			max: 7,
			xtitle: "Time",
			ytitle: "Ratings",
			empty: "You do not have any ratings for this course yet."
			%>
		</div>
		</section>
	</div>
</div>
